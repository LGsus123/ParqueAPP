<div id="map"></div>

<p-toast></p-toast>

<form [formGroup]="reservaForm" class="p-fluid">
  <p-confirmDialog
    header="Confirmar"
    key="plazas-disponibles"
    icon="pi pi-exclamation-triangle">
  </p-confirmDialog>

  <p-dialog 
    header="Seleccione su vehiculo"
    [(visible)]="displayModalPlazas"
    [style]="{ width: '20vw' }"
    [modal]="true"
    (onHide)="redirectToDashboard()"
  >
    <div class="p-col-4 p-md-text-left p-sm-12 p-text-right">
      <div class="position-relative">
        <p-dropdown
          [options]="listaVehiculos"
          formControlName="placa"
          class=""
          optionLabel="plate"
          [filter]="true"
          filterBy="plate"
          [showClear]="true"
          placeholder="Seleccion placa"
          appendTo="body"
          (onChange)="mostrarPlazasDisponiblesPlaca($event.value)"
        >
          <ng-template let-vehiculo pTemplate="item">
            <div class="d-flex align-items-center gap-2">
              <div>{{ vehiculo.plate }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
  </p-dialog>

  <p-dialog
    header="Reserva de parqueadero"
    [(visible)]="displayModalRegistro"
    [style]="{ width: '20vw' }"
  >
    <div class="p-col-4 p-md-text-left p-sm-12 p-text-right">
      <label for="placa">Placa de veh√≠culo:</label>
      <div class="position-relative">
        <p-dropdown
          [options]="listaVehiculos"
          formControlName="placa"
          optionLabel="plate"
          [filter]="true"
          filterBy="plate"
          [showClear]="true"
          placeholder="Seleccion placa"
          appendTo="body"
        >
          <ng-template let-vehiculo pTemplate="item">
            <div class="d-flex align-items-center gap-2">
              <div>{{ vehiculo.plate }}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>

    <div class="p-col-4 p-text-right">
      <label for="fechaReserva">Fecha reserva:</label>
      <div class="p-col-4 p-pt-2">
        <p-calendar
          formControlName="fechaReserva"
          [showIcon]="false"
          label="Fecha reserva:"
          [required]="true"
          appendTo="body"
          [minDate]="minDate" [maxDate]="maxDate" 
          (onSelect)="validateDate()"
        ></p-calendar>
      </div>
    </div>

    <div class="p-col-4 p-text-right">
      <label for="horaEntrada">Hora de entrada:</label>
      <div class="p-col-4 p-pt-2">
        <p-calendar
          [timeOnly]="true"
          formControlName="horaEntrada"
          [showIcon]="false"
          [required]="true"
          [minDate]="minHour"
          (onSelect)="validateTime()" 
          ></p-calendar>
      </div>
    </div>

    <div class="p-col-4 p-text-right">
      <label for="horaSalida">Hora de salida:</label>
      <div class="p-col-4 p-pt-2">
        <p-calendar
          [timeOnly]="true"
          formControlName="horaSalida"
          [showIcon]="false"
          [required]="true"
        ></p-calendar>
      </div>
    </div>
    <hr class="separator" />
    <div class="card flex flex-wrap gap-3 justify-content-center">
      <p-button
        label="Aceptar"
        styleClass="p-button-warning"
        (click)="crearObjetoReserva()"
        [disabled]="reservaForm.invalid"
      ></p-button>
      <p-button
        label="Cancelar"
        styleClass="p-button-outlined p-button-secondary"
        (click)="cancelarReserva()"
      ></p-button>
    </div>
  </p-dialog>
</form>
